# システム構成図

```plantuml
@startuml

file PDFファイル as pdf
agent PDF画像変換器 as pdf_to_image
agent 文章座標抽出器 as text_coordinate_extractor
frame 文章1つに対して{
    node 発見した1つの文章 as text
    agent OCR文字列抽出器 as ocr
    cloud 翻訳API as translator
    node 日本語 as japanese_str
    node 座標 as pos
}
agent 画像上書き器 as image_overwriter
file 翻訳済み画像 as end_node

pdf --> pdf_to_image: pdfファイル
pdf_to_image --> text_coordinate_extractor: 画像ファイル
text_coordinate_extractor --> text
text --> ocr: 文章の\n画像オブジェクト
text --> pos: 座標
pos --> image_overwriter: 座標

ocr --> translator: 英文

translator --> japanese_str
japanese_str --> image_overwriter: 日本語

image_overwriter --> end_node: 画像ファイル

@enduml
```

```plantuml
@startuml

interface "画像オブジェクト" as image{
    + サイズ: 座標
}


class "PDF画像変換器" as pdf_to_image{
    + 変換(PDFファイル): 画像オブジェクト
}


class "文章座標抽出器" as text_coordinate_extractor{
    + 抽出(画像オブジェクト):文章情報
    + 切り取り(文章情報): 文章イメージ
}

note left
抽出()では、入力された画像オブジェクトを元に、
画像オブジェクトの中に描画されている文章を抽出する。

切り取り()では、抽出された文章情報1つずつに対して、
描画されている範囲の画像オブジェクトを切り取り、
画像オブジェクトとして出力する。
end note

pdf_to_image --> text_coordinate_extractor: 画像オブジェクト


interface "座標"{
    + x: int
    + y: int
}

interface "文章情報" as text_info{
    + 切り取り座標_左上: 座標
    + 切り取り座標_右下: 座標
}

note left
入力された画像に対して、
切り取られた範囲が設定される。
end note

text_coordinate_extractor --> text_info : <<create>>


interface "文章イメージ" as text implements image{
    + 切り取り情報: 文章情報
}

text --> text_info


note right
文章イメージとは、
文章が画像オブジェクトとして
描画されているもの
end note

text_coordinate_extractor -->"0..*" text : <<create>>

class "OCR文字列抽出器" as ocr{
    + 文字列抽出(画像オブジェクト): 英文
}


class "翻訳API" as translator{
    + 翻訳(英文): 日本語
}

ocr --> translator: 英文

class "PDF作成器" as output_pdf{
    + 文字列上書き()
}


note bottom
wip: pdfとして、
テキストを追加する方法を
調査する必要がある。
end note


class "画像上書き器" as image_overwriter{
    + 文字列上書き(元の画像: 画像オブジェクト,
        上書きする日本語: str、上書きする座標: 座標)
    - 文字列描画(サイズ: 座標、文字列: str)
}

note bottom
文字列描画()で
上書きする日本語を画像オブジェクトにして、
元の画像オブジェクトに対して上書きをする。
end note


@enduml
```
